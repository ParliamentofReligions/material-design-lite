clone:
  depth: 1
cache:
  mount:
    - node_modules
build:
  image: crhym3/ci-image
  environment:
    - CHROME=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
    - WEBDRIVER=http://chromedriver.storage.googleapis.com/2.16/chromedriver_linux64.zip
    - DISPLAY=:99
  commands:
    - npm install
    # build and unit test
    - echo assume ok
deploy:
  bash:
    image: crhym3/drone-plugin-bash
    env:
      - one=two
    script:
      - env
      - pwd
      - cat /tmp/script.sh
#    when:
#      owner: google
#      branch: master
#    script:
#      - apt-get install -y python-openssl # gcloud deps for service accounts
#      - openssl aes-256-cbc -d -in .drone.p12.enc -out .drone.p12 -pass env:DRONE_PASS
#      - /gcloud/bin/gcloud components update -q gsutil
#      - /gcloud/bin/gcloud auth activate-service-account $$DRONE_ACCOUNT --key-file .drone.p12
#      - gulp publish:staging
